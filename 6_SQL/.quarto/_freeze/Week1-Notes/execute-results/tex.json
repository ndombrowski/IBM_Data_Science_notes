{
  "hash": "22c47d301b5c72b5c0db912f912cb891",
  "result": {
    "markdown": "# Basic SQL\n\n## Introduction\n\nWhat is SQL?\n\n- Structured English Query language\n- Language used for relational databases\n- Used to query data\n\nWhat is data?\n\n- A collection of facts with words, numbers or pictures\n- One of the most critical assets in any business\n- Needs to be secure\n\nWhat is a database?\n\n- A repository of data\n- Provides functionality to add, modify and query data\n- Different kind of databases for different requirements\n\nRelational database:\n\n- Data is stored in tabular form, i.e. consists of rows and columns\n- Columns contain properties, i.e names, age\n- A table is a collection of related things, i.e. list of employees\n- We can make relationships between tables (hence: relational)\n\nDBMS:\n\n- Database Management system, a software to manage databases\n- Interchangeable use of database, database server, database sytem, data server or DBMS\n\n\nRDBMS:\n\n- Relational database management system\n- Set of software tools that controls the data\n  - controls access, organization and storage\n- Examples; MySQL, Oracle, IBM Dbs, etc\n\n\n\n## The SELECT statement\n\n### How to retrieve rows from a table\n\n- After creating a table and inserting data into a table we want to see the data\n- SELECT statement is a data manipulation language (DML) statement used to read and modify data\n- The select statement is called a query\n- The output we get from a query is called the results\n- The basic command looks like this\n\n```\nSELECT * from <tablename>\n```\n\n- We can only retrieve the columns we want, i.e.\n\n```\nSELECT <column1>, <column2> from <tablename>\n```\n\n- The order in the columns displayed table matches the order in the used select statement\n\n### Restricting the results set via the WHERE clause\n\n- This clause restricts the results set\n- Requires a predicate that is conditions to\n  - evaluate to true, false or unknown\n  - predicates are used in the search condition of the where clause\n- Example: We want to have the title from the book with the book ID B1\n\n```\nSELECT column1, column2, ...\nFROM table_name\nWHERE condition\n;\n```\n\n- FROM: Specifies from which table to get the data. The clause can include optional JOIN subclauses to specify the rules for joining tables.\n- [Optional Clause] WHERE : Specifies which rows to retrieve.\n- Some database systems require a semicolon at the end of each SQL statement for execution. It is a standard way to separate one SQL statement from another which allows more than one SQL statement to be executed in the same call to the server. So, it is good practice to use a semicolon at the end of each SQL statement.\n\n```\nSELECT book_id, title from Book.db\n  WHERE book_id = 'B1'\n```\n\n- We can also use other comparison operators\n  - equal to --> =\n  - greater than --> >\n  - less than --> <\n  - greater than or equal to --> >=\n  - less than or equal to --> <=\n  - not equal to --> <>\n  \n\n### Exercise\n  \nTo reproduce the example, we\n\n- Downloaded datasette from the web\n- Downloaded the SanFranciscoFilmLocations database as csv from [here](https://data.sfgov.org/Culture-and-Recreation/Film-Locations-in-San-Francisco/yitu-d5am/data)\n- we converted this to a datasette database with `csvs-to-sqlite Film_Locations_in_San_Francisco.csv Film_Locations_in_San_Francisco.db`\n- and opened the datasette with `datasette Film_Locations_in_San_Francisco.db`\n\nWe can also load the db into r:\n\n#### Task A: explore the database\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DBI)\ndb = dbConnect(RSQLite::SQLite(), dbname =\"Week1/Film_Locations_in_San_Francisco.db\")\n\n#set connection for each chunk, other wise we would need `{sql, connection=db}`\nknitr::opts_chunk$set(connection = \"db\", max.print = 10)\n#knitr::opts_chunk$set(connection = \"db2\", max.print = 5)\n\n#show less columns\n#options(max.print = 5)\n```\n:::\n\n\n\n#### Task B: Example exercises\n\n1. In this example, suppose we want to retrieve details of all the films from the \"FilmLocations\" table. The details of each film record should contain all the film columns.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT * FROM Film_Locations_in_San_Francisco\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title              | Release Year|Locations                                 |Fun Facts                                                                                                                                                                                                                        |Production Company                     |Distributor               |Director          |Writer            |Actor 1         |Actor 2            |Actor 3       |\n|:------------------|------------:|:-----------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------|:-------------------------|:-----------------|:-----------------|:---------------|:------------------|:-------------|\n|A Jitney Elopement |         1915|20th and Folsom Streets                   |NA                                                                                                                                                                                                                               |The Essanay Film Manufacturing Company |General Film Company      |Charles Chaplin   |Charles Chaplin   |Charles Chaplin |Edna Purviance     |NA            |\n|A Jitney Elopement |         1915|Golden Gate Park                          |During San Francisco's Gold Rush era, the Park was part of an area designated as the \"Great Sand Waste\".                                                                                                                         |The Essanay Film Manufacturing Company |General Film Company      |Charles Chaplin   |Charles Chaplin   |Charles Chaplin |Edna Purviance     |NA            |\n|Greed              |         1924|Cliff House (1090 Point Lobos Avenue)     |In 1887, the Cliff House was severely damaged when the schooner Parallel, abandoned and loaded with dynamite, ran aground on the rocks below.                                                                                    |Metro-Goldwyn-Mayer (MGM)              |Metro-Goldwyn-Mayer (MGM) |Eric von Stroheim |Eric von Stroheim |Zasu Pitts      |Gibson Gowland     |Jean Hersholt |\n|Greed              |         1924|Bush and Sutter Streets                   |NA                                                                                                                                                                                                                               |Metro-Goldwyn-Mayer (MGM)              |Metro-Goldwyn-Mayer (MGM) |Eric von Stroheim |Eric von Stroheim |Zasu Pitts      |Gibson Gowland     |Jean Hersholt |\n|Greed              |         1924|Hayes Street at Laguna                    |NA                                                                                                                                                                                                                               |Metro-Goldwyn-Mayer (MGM)              |Metro-Goldwyn-Mayer (MGM) |Eric von Stroheim |Eric von Stroheim |Zasu Pitts      |Gibson Gowland     |Jean Hersholt |\n|The Jazz Singer    |         1927|Coffee Dan's (O'Farrell Street at Powell) |NA                                                                                                                                                                                                                               |Warner Bros. Pictures                  |Warner Bros. Pictures     |Alan Crosland     |Alfred A. Cohn    |Al Jolson       |May McAvoy         |Warner Oland  |\n|Barbary Coast      |         1935|NA                                        |NA                                                                                                                                                                                                                               |The Samuel Goldwyn Company             |United Artists            |Howard Hawks      |Ben Hecht         |Mariam Hopkins  |Edward G. Robinson |Joel McCrea   |\n|After the Thin Man |         1936|Coit Tower                                |The Tower was funded by a gift bequeathed by Lillie Hitchcock Coit, a socialite who reportedly liked to chase fires. Though the tower resembles a firehose nozzle, it was not designed this way.                                 |Metro-Goldwyn Mayer                    |Metro-Goldwyn Mayer       |W.S. Van Dyke     |Frances Goodrich  |William Powell  |Myrna Loy          |James Stewart |\n|San Francisco      |         1936|The Barbary Coast                         |The Barbary Coast was a red-light district that was largely destroyed in the 1906 earthquake. Though some of the establishments were rebuilt after the earthquake, an anti-vice campaign put the establishments out of business. |Metro-Goldwyn Mayer                    |Metro-Goldwyn Mayer       |W.S. Van Dyke     |Anita Loos        |Clark Gable     |Jeanette MacDonald |Spencer Tracy |\n|San Francisco      |         1936|City Hall                                 |The dome of SF's City Hall is almost a foot taller than that of the US Capitol Building. In 1954, Joe DiMaggio and Marilyn Monroe married at the Beaux Arts-style building.                                                      |Metro-Goldwyn Mayer                    |Metro-Goldwyn Mayer       |W.S. Van Dyke     |Anita Loos        |Clark Gable     |Jeanette MacDonald |Spencer Tracy |\n:::\n\n\n\n\n2. In this example, now we want to retrieve selective details of all the film records. Let us retrieve the names of all the films along with director names and writer names.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT Title, Director,Writer FROM Film_Locations_in_San_Francisco\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title              |Director          |Writer            |\n|:------------------|:-----------------|:-----------------|\n|A Jitney Elopement |Charles Chaplin   |Charles Chaplin   |\n|A Jitney Elopement |Charles Chaplin   |Charles Chaplin   |\n|Greed              |Eric von Stroheim |Eric von Stroheim |\n|Greed              |Eric von Stroheim |Eric von Stroheim |\n|Greed              |Eric von Stroheim |Eric von Stroheim |\n|The Jazz Singer    |Alan Crosland     |Alfred A. Cohn    |\n|Barbary Coast      |Howard Hawks      |Ben Hecht         |\n|After the Thin Man |W.S. Van Dyke     |Frances Goodrich  |\n|San Francisco      |W.S. Van Dyke     |Anita Loos        |\n|San Francisco      |W.S. Van Dyke     |Anita Loos        |\n:::\n\n\n\n\n3. In this example, we want to retrieve film names along with filming locations and release years. But we also want to restrict the output resultset so that we can retrieve only the film records released in 2001 and onwards (release years after 2001 including 2001).\n\n**Notice** If we have a space in the column header, we need to use quotes.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT Title, Locations,\"Release Year\" FROM Film_Locations_in_San_Francisco\nWHERE \"Release Year\" >=2001\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title                      |Locations                                                            | Release Year|\n|:--------------------------|:--------------------------------------------------------------------|------------:|\n|By Hook or By Crook        |The Lexington Club (3464 19th Street at Lexington)                   |         2001|\n|By Hook or By Crook        |Royan Hotel (405 Valencia Street, Mission District)                  |         2001|\n|By Hook or By Crook        |Department of Public Health (101 Grove Street at Polk, Civic Center) |         2001|\n|Dr. Dolittle 2             |West Chrissy Field (Presidio, Golden Gate National Recreation Area)  |         2001|\n|Dr. Dolittle 2             |Sacramento St., Between Pierce & Broderick Streets                   |         2001|\n|Dr. Dolittle 2             |Hyde Street & Lombard Street                                         |         2001|\n|Dr. Dolittle 2             |Building 924, Presidio (Golden Gate National Recreation Area)        |         2001|\n|Dr. Dolittle 2             |Broadway, Between Franklin & Laguna Streets                          |         2001|\n|Haiku Tunnel               |NA                                                                   |         2001|\n|Mission (aka City of Bars) |The 500 Club (500 Guerrero Street, Mission District)                 |         2001|\n:::\n\n\n4. Retrieve the fun facts and filming locations of all films.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT \"Fun Facts\",Locations FROM Film_Locations_in_San_Francisco\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Fun Facts                                                                                                                                                                                                                        |Locations                                 |\n|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------|\n|NA                                                                                                                                                                                                                               |20th and Folsom Streets                   |\n|During San Francisco's Gold Rush era, the Park was part of an area designated as the \"Great Sand Waste\".                                                                                                                         |Golden Gate Park                          |\n|In 1887, the Cliff House was severely damaged when the schooner Parallel, abandoned and loaded with dynamite, ran aground on the rocks below.                                                                                    |Cliff House (1090 Point Lobos Avenue)     |\n|NA                                                                                                                                                                                                                               |Bush and Sutter Streets                   |\n|NA                                                                                                                                                                                                                               |Hayes Street at Laguna                    |\n|NA                                                                                                                                                                                                                               |Coffee Dan's (O'Farrell Street at Powell) |\n|NA                                                                                                                                                                                                                               |NA                                        |\n|The Tower was funded by a gift bequeathed by Lillie Hitchcock Coit, a socialite who reportedly liked to chase fires. Though the tower resembles a firehose nozzle, it was not designed this way.                                 |Coit Tower                                |\n|The Barbary Coast was a red-light district that was largely destroyed in the 1906 earthquake. Though some of the establishments were rebuilt after the earthquake, an anti-vice campaign put the establishments out of business. |The Barbary Coast                         |\n|The dome of SF's City Hall is almost a foot taller than that of the US Capitol Building. In 1954, Joe DiMaggio and Marilyn Monroe married at the Beaux Arts-style building.                                                      |City Hall                                 |\n:::\n\n\n5. Retrieve the names of all films released in the 20th century and before (release years before 2000 including 2000) that, along with filming locations and release years.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT Title,Locations,\"Release Year\" FROM Film_Locations_in_San_Francisco\nWHERE \"Release Year\" <= 2000\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title              |Locations                                 | Release Year|\n|:------------------|:-----------------------------------------|------------:|\n|A Jitney Elopement |20th and Folsom Streets                   |         1915|\n|A Jitney Elopement |Golden Gate Park                          |         1915|\n|Greed              |Cliff House (1090 Point Lobos Avenue)     |         1924|\n|Greed              |Bush and Sutter Streets                   |         1924|\n|Greed              |Hayes Street at Laguna                    |         1924|\n|The Jazz Singer    |Coffee Dan's (O'Farrell Street at Powell) |         1927|\n|Barbary Coast      |NA                                        |         1935|\n|After the Thin Man |Coit Tower                                |         1936|\n|San Francisco      |The Barbary Coast                         |         1936|\n|San Francisco      |City Hall                                 |         1936|\n:::\n\n\n6. Retrieve the names, production company names, filming locations, and release years of the films which are not written by James Cameron.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT Title,\"Production Company\",Locations, \"Release Year\", Writer FROM Film_Locations_in_San_Francisco\nWHERE Writer <> \"James Cameron\"\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title              |Production Company                     |Locations                                 | Release Year|Writer            |\n|:------------------|:--------------------------------------|:-----------------------------------------|------------:|:-----------------|\n|A Jitney Elopement |The Essanay Film Manufacturing Company |20th and Folsom Streets                   |         1915|Charles Chaplin   |\n|A Jitney Elopement |The Essanay Film Manufacturing Company |Golden Gate Park                          |         1915|Charles Chaplin   |\n|Greed              |Metro-Goldwyn-Mayer (MGM)              |Cliff House (1090 Point Lobos Avenue)     |         1924|Eric von Stroheim |\n|Greed              |Metro-Goldwyn-Mayer (MGM)              |Bush and Sutter Streets                   |         1924|Eric von Stroheim |\n|Greed              |Metro-Goldwyn-Mayer (MGM)              |Hayes Street at Laguna                    |         1924|Eric von Stroheim |\n|The Jazz Singer    |Warner Bros. Pictures                  |Coffee Dan's (O'Farrell Street at Powell) |         1927|Alfred A. Cohn    |\n|Barbary Coast      |The Samuel Goldwyn Company             |NA                                        |         1935|Ben Hecht         |\n|After the Thin Man |Metro-Goldwyn Mayer                    |Coit Tower                                |         1936|Frances Goodrich  |\n|San Francisco      |Metro-Goldwyn Mayer                    |The Barbary Coast                         |         1936|Anita Loos        |\n|San Francisco      |Metro-Goldwyn Mayer                    |City Hall                                 |         1936|Anita Loos        |\n:::\n\n\n\n## Count, Distinct, limit\n\n### Count\n\n- Number of rows that meet target criteria\n- `select COUNT(*) from table` to get the total number of rows in a table\n- `select COUNT(COUNTRY) from Medals; where COUNTRY='Canada'`: Rows in the medals table were the country is Canada\n\n\n### Distinct\n\n- Remove duplicate values\n- `select DISTINCT columnname from table `: retrieve unique values in a column\n- `select DISTINCT Country from Medals; where Medaltype == 'GOLD'`: get a list of unique countries that received gold medals\n\n\n### Limit\n\n- Used to restrict the number of rows retrieved from a database\n- `select * from table LIMIT 10`: retrieve only the first 10 rows\n- `select * from Medals; where YEAR = 2018 LIMIT 5`: retrieve 5 rows in the Medals table for a specific year\n\n\n\n#### Exercises\n\n1. Retrieve the number of rows from the \"FilmLocations\" table.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect COUNT(*) from Film_Locations_in_San_Francisco\n```\n\n\n\n\nTable: 1 records\n\n| COUNT(*)|\n|--------:|\n|     1976|\n:::\n\n\n2. In this example, now we want to count the number of locations of the films. But we also want to restrict the output resultset in such a way that we only retrieve the number of locations of the films written by a certain writer. Retrieve the number of locations of the films which are written by James Cameron.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect COUNT(Locations) from Film_Locations_in_San_Francisco\nwhere Writer = \"James Cameron\"\n```\n\n\n\n\nTable: 1 records\n\n| COUNT(Locations)|\n|----------------:|\n|               24|\n:::\n\n\n3. Retrieve the number of locations of the films which are directed by Woody Allen.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect COUNT(Locations) from Film_Locations_in_San_Francisco\nwhere Director = \"Woody Allen\"\n```\n\n\n\n\nTable: 1 records\n\n| COUNT(Locations)|\n|----------------:|\n|               31|\n:::\n\n\n\n4. Retrieve the number of films shot at Russian Hill.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect COUNT(Title) from Film_Locations_in_San_Francisco\nwhere Locations = \"Russian Hill\"\n```\n\n\n\n\nTable: 1 records\n\n| COUNT(Title)|\n|------------:|\n|            1|\n:::\n\n\n5. Retrieve the number of rows having a release year older than 1950 from the \"FilmLocations\" table.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect COUNT(*) from Film_Locations_in_San_Francisco\nwhere \"Release Year\" > 1950\n```\n\n\n\n\nTable: 1 records\n\n| COUNT(*)|\n|--------:|\n|     1929|\n:::\n\n\n\n6. In this example, we want to retrieve the title of all films in the table in such a way that duplicates will be discarded in the output resultset. Retrieve the name of all films without any repeated titles.\n\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect DISTINCT Title from Film_Locations_in_San_Francisco\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title                    |\n|:------------------------|\n|A Jitney Elopement       |\n|Greed                    |\n|The Jazz Singer          |\n|Barbary Coast            |\n|After the Thin Man       |\n|San Francisco            |\n|Alexander's Ragtime Band |\n|Shadow of the Thin Man   |\n|The Maltese Falcon       |\n|Gentleman Jim            |\n:::\n\n\n\n7. In this example, we want to retrieve the count of release years of the films produced by a specific company in such a way that duplicate release years of those films will be discarded in the count. Retrieve the number of release years of the films distinctly, produced by Warner Bros. Pictures.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect COUNT(DISTINCT \"Release Year\") from Film_Locations_in_San_Francisco\nwhere \"Production Company\" = \"Warner Bros. Pictures\"\n```\n\n\n\n\nTable: 1 records\n\n| COUNT(DISTINCT \"Release Year\")|\n|------------------------------:|\n|                             14|\n:::\n\n\n8. Retrieve the name of all unique films released in the 21st century and onwards, along with their release years.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect DISTINCT Title, \"Release Year\" from Film_Locations_in_San_Francisco\nwhere \"Release Year\" >= 2001\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title                      | Release Year|\n|:--------------------------|------------:|\n|By Hook or By Crook        |         2001|\n|Dr. Dolittle 2             |         2001|\n|Haiku Tunnel               |         2001|\n|Mission (aka City of Bars) |         2001|\n|Never Die Twice            |         2001|\n|Serendipity                |         2001|\n|Sweet November             |         2001|\n|The Princess Diaries       |         2001|\n|The Wedding Planner        |         2001|\n|40 Days and 40 Nights      |         2002|\n:::\n\n\n\n9. Retrieve the names of all the directors and their distinct films shot at City Hall.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect DISTINCT Director, Title from Film_Locations_in_San_Francisco\nwhere Locations = \"City Hall\"\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Director             |Title                          |\n|:--------------------|:------------------------------|\n|W.S. Van Dyke        |San Francisco                  |\n|Ted Post             |Magnum Force                   |\n|James Fargo          |The Enforcer                   |\n|Colin Higgins        |Foul Play                      |\n|Philip Kaufman       |Invasion of the Body Snatchers |\n|Philip Kaufman       |The Right Stuff                |\n|John Glen            |A View to a Kill               |\n|Richard Marquand     |Jagged Edge                    |\n|Francis Ford Coppola |Tucker: The Man and His Dream  |\n|Michael Apted        |Class Action                   |\n:::\n\n\n\n\n10. Retrieve the number of distributors distinctly who distributed films acted by Clint Eastwood as 1st actor.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect COUNT (DISTINCT Distributor) from Film_Locations_in_San_Francisco\nwhere \"Actor 1\" = \"Clint Eastwood\"\n```\n\n\n\n\nTable: 1 records\n\n| COUNT (DISTINCT Distributor)|\n|----------------------------:|\n|                            3|\n:::\n\n\n\n11. In this example, let us retrieve a specific number of rows from the top of the table in such a way that rows other than those are not in the output resultset. Retrieve the first 25 rows from the \"FilmLocations\" table.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect * from Film_Locations_in_San_Francisco Limit 25\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title              | Release Year|Locations                                 |Fun Facts                                                                                                                                                                                                                        |Production Company                     |Distributor               |Director          |Writer            |Actor 1         |Actor 2            |Actor 3       |\n|:------------------|------------:|:-----------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------|:-------------------------|:-----------------|:-----------------|:---------------|:------------------|:-------------|\n|A Jitney Elopement |         1915|20th and Folsom Streets                   |NA                                                                                                                                                                                                                               |The Essanay Film Manufacturing Company |General Film Company      |Charles Chaplin   |Charles Chaplin   |Charles Chaplin |Edna Purviance     |NA            |\n|A Jitney Elopement |         1915|Golden Gate Park                          |During San Francisco's Gold Rush era, the Park was part of an area designated as the \"Great Sand Waste\".                                                                                                                         |The Essanay Film Manufacturing Company |General Film Company      |Charles Chaplin   |Charles Chaplin   |Charles Chaplin |Edna Purviance     |NA            |\n|Greed              |         1924|Cliff House (1090 Point Lobos Avenue)     |In 1887, the Cliff House was severely damaged when the schooner Parallel, abandoned and loaded with dynamite, ran aground on the rocks below.                                                                                    |Metro-Goldwyn-Mayer (MGM)              |Metro-Goldwyn-Mayer (MGM) |Eric von Stroheim |Eric von Stroheim |Zasu Pitts      |Gibson Gowland     |Jean Hersholt |\n|Greed              |         1924|Bush and Sutter Streets                   |NA                                                                                                                                                                                                                               |Metro-Goldwyn-Mayer (MGM)              |Metro-Goldwyn-Mayer (MGM) |Eric von Stroheim |Eric von Stroheim |Zasu Pitts      |Gibson Gowland     |Jean Hersholt |\n|Greed              |         1924|Hayes Street at Laguna                    |NA                                                                                                                                                                                                                               |Metro-Goldwyn-Mayer (MGM)              |Metro-Goldwyn-Mayer (MGM) |Eric von Stroheim |Eric von Stroheim |Zasu Pitts      |Gibson Gowland     |Jean Hersholt |\n|The Jazz Singer    |         1927|Coffee Dan's (O'Farrell Street at Powell) |NA                                                                                                                                                                                                                               |Warner Bros. Pictures                  |Warner Bros. Pictures     |Alan Crosland     |Alfred A. Cohn    |Al Jolson       |May McAvoy         |Warner Oland  |\n|Barbary Coast      |         1935|NA                                        |NA                                                                                                                                                                                                                               |The Samuel Goldwyn Company             |United Artists            |Howard Hawks      |Ben Hecht         |Mariam Hopkins  |Edward G. Robinson |Joel McCrea   |\n|After the Thin Man |         1936|Coit Tower                                |The Tower was funded by a gift bequeathed by Lillie Hitchcock Coit, a socialite who reportedly liked to chase fires. Though the tower resembles a firehose nozzle, it was not designed this way.                                 |Metro-Goldwyn Mayer                    |Metro-Goldwyn Mayer       |W.S. Van Dyke     |Frances Goodrich  |William Powell  |Myrna Loy          |James Stewart |\n|San Francisco      |         1936|The Barbary Coast                         |The Barbary Coast was a red-light district that was largely destroyed in the 1906 earthquake. Though some of the establishments were rebuilt after the earthquake, an anti-vice campaign put the establishments out of business. |Metro-Goldwyn Mayer                    |Metro-Goldwyn Mayer       |W.S. Van Dyke     |Anita Loos        |Clark Gable     |Jeanette MacDonald |Spencer Tracy |\n|San Francisco      |         1936|City Hall                                 |The dome of SF's City Hall is almost a foot taller than that of the US Capitol Building. In 1954, Joe DiMaggio and Marilyn Monroe married at the Beaux Arts-style building.                                                      |Metro-Goldwyn Mayer                    |Metro-Goldwyn Mayer       |W.S. Van Dyke     |Anita Loos        |Clark Gable     |Jeanette MacDonald |Spencer Tracy |\n:::\n\n\n\n12. In this example, let us take the first example to a more advanced level. Now we want to retrieve a specific number of rows from the table, but this time, not from the top of the table. This time we want to retrieve a specific number of rows starting from a specific row in the table. Retrieve the first 15 rows from the \"FilmLocations\" table starting from row 11. For this we use **OFFSET**\n\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect * from Film_Locations_in_San_Francisco Limit 15 OFFSET 10\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title                    | Release Year|Locations                                                            |Fun Facts                                                                                                                                                                                                                                            |Production Company                     |Distributor                            |Director          |Writer                      |Actor 1         |Actor 2      |Actor 3       |\n|:------------------------|------------:|:--------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------|:--------------------------------------|:-----------------|:---------------------------|:---------------|:------------|:-------------|\n|Alexander's Ragtime Band |         1938|Cliff House (1090 Point Lobos Avenue)                                |In 1887, the Cliff House was severely damaged when the schooner Parallel, abandoned and loaded with dynamite, ran aground on the rocks below.                                                                                                        |Twentieth Century Fox Film Corporation |Twentieth Century Fox Film Corporation |Henry King        |Kathryn Scola               |Tyrone Power    |Alice Faye   |Don Ameche    |\n|Alexander's Ragtime Band |         1938|San Francisco Bay                                                    |NA                                                                                                                                                                                                                                                   |Twentieth Century Fox Film Corporation |Twentieth Century Fox Film Corporation |Henry King        |Kathryn Scola               |Tyrone Power    |Alice Faye   |Don Ameche    |\n|Alexander's Ragtime Band |         1938|Fairmont Hotel (950 Mason Street, Nob Hill)                          |In 1945 the Fairmont hosted the United Nations Conference on International Organization as delegates arrived to draft a charter for the organization. The U.S. Secretary of State, Edward Stettinius drafted the charter in the hotel's Garden Room. |Twentieth Century Fox Film Corporation |Twentieth Century Fox Film Corporation |Henry King        |Kathryn Scola               |Tyrone Power    |Alice Faye   |Don Ameche    |\n|Shadow of the Thin Man   |         1941|Bay Bridge                                                           |Before opening in 1936, the bridge was blessed by Cardinal Secretary of State Eugenio Pacelli, who later became Pope Pius XII.                                                                                                                       |Metro-Goldwyn Mayer                    |Metro-Goldwyn Mayer                    |W.S. Van Dyke     |Harry Kurnitz               |William Powell  |Myrna Loy    |Barry Nelson  |\n|The Maltese Falcon       |         1941|Golden Gate Bridge                                                   |With 23 miles of ladders and 300,000 rivets in each tower, the Golden Gate Bridge was the world's longest span when it opened in 1937.                                                                                                               |Warner Bros. Pictures                  |Warner Bros. Pictures                  |John Huston       |John Huston                 |Humphrey Bogart |Mary Astor   |Gladys George |\n|The Maltese Falcon       |         1941|Ferry Building                                                       |Every hour and half-hour, the clock bell atop the Ferry Building chimes portions of the Westminster Quarters.                                                                                                                                        |Warner Bros. Pictures                  |Warner Bros. Pictures                  |John Huston       |John Huston                 |Humphrey Bogart |Mary Astor   |Gladys George |\n|The Maltese Falcon       |         1941|Burritt Alley (Off Bush Street, between Powell and Stockton Streets) |NA                                                                                                                                                                                                                                                   |Warner Bros. Pictures                  |Warner Bros. Pictures                  |John Huston       |John Huston                 |Humphrey Bogart |Mary Astor   |Gladys George |\n|Gentleman Jim            |         1942|The Barbary Coast                                                    |The Barbary Coast was a red-light district that was largely destroyed in the 1906 earthquake. Though some of the establishments were rebuilt after the earthquake, an anti-vice campaign put the establishments out of business.                     |Warner Bros. Pictures                  |Warner Bros. Pictures                  |Raoul Walsh       |Vincent Lawrence            |Errol Flynn     |Alexis Smith |Jack Carson   |\n|Hello Frisco, Hello      |         1943|NA                                                                   |NA                                                                                                                                                                                                                                                   |Twentieth Century Fox Film Corporation |Twentieth Century Fox Film Corporation |Bruce Humberstone |Robert Ellis                |Alice Faye      |John Payne   |Jack Oakie    |\n|Dark Passage             |         1947|Golden Gate Bridge                                                   |With 23 miles of ladders and 300,000 rivets in each tower, the Golden Gate Bridge was the world's longest span when it opened in 1937.                                                                                                               |Warner Bros. Pictures                  |Warner Bros. Pictures                  |Delmer Daves      |Delmer Daves & David Goodis |Humphrey Bogart |Lauren Bacal |Bruce Bennett |\n:::\n\n\n\n13. Retrieve the name of first 50 films distinctly.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect Distinct Title from Film_Locations_in_San_Francisco Limit 50\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title                    |\n|:------------------------|\n|A Jitney Elopement       |\n|Greed                    |\n|The Jazz Singer          |\n|Barbary Coast            |\n|After the Thin Man       |\n|San Francisco            |\n|Alexander's Ragtime Band |\n|Shadow of the Thin Man   |\n|The Maltese Falcon       |\n|Gentleman Jim            |\n:::\n\n\n\n14. Retrieve first 10 film names distinctly released in 2015.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect Distinct Title from Film_Locations_in_San_Francisco\nwhere \"Release Year\" = 2015 Limit 10\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n|Title                   |\n|:-----------------------|\n|Age of Adaline          |\n|Americana               |\n|Ant-Man                 |\n|Cardinal X              |\n|I Am Michael            |\n|Looking Season 2 ep 202 |\n|Looking Season 2 ep 203 |\n|Looking Season 2 ep 204 |\n|Looking Season 2 ep 205 |\n|Looking Season 2 ep 206 |\n:::\n\n\n\n\n15. Retrieve the next 3 film names distinctly after first 5 films released in 2015.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nselect Distinct Title from Film_Locations_in_San_Francisco\nwhere \"Release Year\" = 2015 Limit 3 OFFSET 5\n```\n\n\n\n\nTable: 3 records\n\n|Title                   |\n|:-----------------------|\n|Looking Season 2 ep 202 |\n|Looking Season 2 ep 203 |\n|Looking Season 2 ep 204 |\n:::\n\n\n\n\n## Insert\n\n- The insert statement is used to add rows to a table\n- Its a DML statement used to read and modify data\n\nI.e lets add something to the author table, ie a new author:\n\n```\nInsert into Author.db\n  (Author_ID, Lastname, Firstname)\nValues(\"A1\", \"Chong\", \"Raul\")\n```\n\n- Important: the number of provided values should equal the number of column names specified in the column name list \n\nWe can insert multiple rows like this:\n\n```\nInsert into Author.db\n  (Author_ID, Lastname, Firstname)\nValues\n  (\"A1\", \"Chong\", \"Raul\")\n  (\"A2\", \"Ahuja\", \"Rai\")\n```\n\n\n## Update\n\n- Update is used alter existing data in a table\n- If we don't specify the where statement, ALL rows in the table will be updated\n\nWe want to update the Last and first Name for the author with the ID A2:\n\n```\nUpdate Author.db\nSET LastName=\"Katta\"\n  Firstname=\"Lakshimi\"\n  Where author_id='A2'\n```\n\n\n\n## Delete\n\n- used to remove 1 or more rows\n\nWe want to delete the rows for author ID A2 and A3\n\n```\nDelete from author.db\n  Where author_id IN ('A2', \"A3\")\n```\n\n\n### Exercise\n\nPrepare the data by copy/pasting the data from the online tutorial into excel and save as csv. It was converted to an sql database with `csvs-to-sqlite Instructor.csv Instructor.db`\n\nPrep database for R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndb2 = dbConnect(RSQLite::SQLite(), dbname =\"Week1/Instructor.db\")\n```\n:::\n\n\n\n\n1. First have a look at the database\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n| ins_id|lastname   |firstname |city      |country |\n|------:|:----------|:---------|:---------|:-------|\n|      1|Ahuja      |Rav       |Markham   |CA      |\n|      2|Chong      |Raul      |Toronto   |CA      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n|      8|Ryan       |Steve     |Varly     |GB      |\n|      9|Sannareddy |Ramesh    |Hyderabad |IN      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n:::\n\n\n\n2. In this example, suppose we want to insert a new single row into the Instructor table. Insert a new instructor record with id 4 for Sandip Saha who lives in Edmonton, CA into the \"Instructor\" table.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nInsert into Instructor (ins_id, lastname, firstname, city, country)\nVALUES (\"4\", \"Sandip\", \"Saha\", \"Edmonton\", \"CA\")\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n| ins_id|lastname   |firstname |city      |country |\n|------:|:----------|:---------|:---------|:-------|\n|      1|Ahuja      |Rav       |Markham   |CA      |\n|      2|Chong      |Raul      |Toronto   |CA      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n|      8|Ryan       |Steve     |Varly     |GB      |\n|      9|Sannareddy |Ramesh    |Hyderabad |IN      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n:::\n\n\n\n3. n this example, suppose we want to insert some new multiple rows into the Instructor table. Insert two new instructor records into the \"Instructor\" table. First record with id 5 for John Doe who lives in Sydney, AU. Second record with id 6 for Jane Doe who lives in Dhaka, BD.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nINSERT INTO Instructor(ins_id, lastname, firstname, city, country)\nVALUES(5, 'Doe', 'John', 'Sydney', 'AU'), (6, 'Doe', 'Jane', 'Dhaka', 'BD') \n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor Limit 10\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n| ins_id|lastname   |firstname |city      |country |\n|------:|:----------|:---------|:---------|:-------|\n|      1|Ahuja      |Rav       |Markham   |CA      |\n|      2|Chong      |Raul      |Toronto   |CA      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n|      8|Ryan       |Steve     |Varly     |GB      |\n|      9|Sannareddy |Ramesh    |Hyderabad |IN      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n:::\n\n\n\n4. Insert a new instructor record with id 7 for Antonio Cangiano who lives in Vancouver, CA into the \"Instructor\" table.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nInsert into Instructor(ins_id, lastname, firstname, city, country)\nValues(7, \"Cangiano\", \"Antonio\", \"Vancouver\", \"CA\")\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor Limit 5 OFFSET 4\n```\n\n\n\n\nTable: 5 records\n\n| ins_id|lastname   |firstname |city      |country |\n|------:|:----------|:---------|:---------|:-------|\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n|      8|Ryan       |Steve     |Varly     |GB      |\n|      9|Sannareddy |Ramesh    |Hyderabad |IN      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n:::\n\n\n\n5. nsert two new instructor records into the \"Instructor\" table. First record with id 8 for Steve Ryan who lives in Barlby, GB. Second record with id 9 for Ramesh Sannareddy who lives in Hyderabad, IN.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nInsert into Instructor(ins_id, lastname, firstname, city, country)\nValues(8, \"Ryan\", \"Steve\", \"Varly\", \"GB\"),(9, \"Sannareddy\", \"Ramesh\", \"Hyderabad\", \"IN\")\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor Limit 5 OFFSET 4\n```\n\n\n\n\nTable: 5 records\n\n| ins_id|lastname   |firstname |city      |country |\n|------:|:----------|:---------|:---------|:-------|\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n|      8|Ryan       |Steve     |Varly     |GB      |\n|      9|Sannareddy |Ramesh    |Hyderabad |IN      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n:::\n\n\n\n6. In this example, we want to update one column of an existing row of the table. Update the city for Sandip to Toronto.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nUpdate Instructor\nSet city=\"Toronto\"\nWhere lastname=\"Sandip\"\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor\n```\n\n\n\n\nTable: Displaying records 1 - 10\n\n| ins_id|lastname   |firstname |city      |country |\n|------:|:----------|:---------|:---------|:-------|\n|      1|Ahuja      |Rav       |Markham   |CA      |\n|      2|Chong      |Raul      |Toronto   |CA      |\n|      4|Sandip     |Saha      |Toronto   |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n|      8|Ryan       |Steve     |Varly     |GB      |\n|      9|Sannareddy |Ramesh    |Hyderabad |IN      |\n|      4|Sandip     |Saha      |Toronto   |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n:::\n\n\n\n7. Update the city and country for Doe with id 5 to Dubai and AE respectively.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nUpdate Instructor\nSet city=\"Dubai\", country=\"AE\"\nWhere lastname=\"Doe\"\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor Limit 5 Offset 2\n```\n\n\n\n\nTable: 5 records\n\n| ins_id|lastname   |firstname |city      |country |\n|------:|:----------|:---------|:---------|:-------|\n|      4|Sandip     |Saha      |Toronto   |DB      |\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n|      8|Ryan       |Steve     |Varly     |GB      |\n|      9|Sannareddy |Ramesh    |Hyderabad |IN      |\n:::\n\n\n\n\n8. Update the city of the instructor record to Markham whose id is 1.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nUpdate Instructor\nSet city=\"Markham\"\nWhere ins_id=1\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor Limit 5 Offset 0\n```\n\n\n\n\nTable: 5 records\n\n| ins_id|lastname |firstname |city      |country |\n|------:|:--------|:---------|:---------|:-------|\n|      1|Ahuja    |Rav       |Markham   |CA      |\n|      2|Chong    |Raul      |Toronto   |CA      |\n|      4|Sandip   |Saha      |Toronto   |DB      |\n|      5|Doe      |John      |Dubai     |AE      |\n|      7|Cangiano |Antonio   |Vancouver |CA      |\n:::\n\n\n\n9. Update the city and country for Sandip with id 4 to Dhaka and BD respectively.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nUpdate Instructor\nSet city=\"Dhaka\", country=\"DB\"\nWhere ins_id=4\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor Limit 5 Offset 1\n```\n\n\n\n\nTable: 5 records\n\n| ins_id|lastname |firstname |city      |country |\n|------:|:--------|:---------|:---------|:-------|\n|      2|Chong    |Raul      |Toronto   |CA      |\n|      4|Sandip   |Saha      |Dhaka     |DB      |\n|      5|Doe      |John      |Dubai     |AE      |\n|      7|Cangiano |Antonio   |Vancouver |CA      |\n|      8|Ryan     |Steve     |Varly     |GB      |\n:::\n\n\n\n10. In this example, we want to remove a row from the table. Remove the instructor record of Doe whose id is 6.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nDelete from Instructor\nwhere ins_id=6\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor Limit 5 Offset 3\n```\n\n\n\n\nTable: 5 records\n\n| ins_id|lastname   |firstname |city      |country |\n|------:|:----------|:---------|:---------|:-------|\n|      5|Doe        |John      |Dubai     |AE      |\n|      7|Cangiano   |Antonio   |Vancouver |CA      |\n|      8|Ryan       |Steve     |Varly     |GB      |\n|      9|Sannareddy |Ramesh    |Hyderabad |IN      |\n|      4|Sandip     |Saha      |Dhaka     |DB      |\n:::\n\n\n\n11. Remove the instructor record of Hima.\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nDelete from Instructor\nWhere firstname=\"Hima\"\n```\n:::\n\n::: {.cell}\n\n```{.sql .cell-code}\nSelect * from Instructor Limit 5\n```\n\n\n\n\nTable: 5 records\n\n| ins_id|lastname |firstname |city      |country |\n|------:|:--------|:---------|:---------|:-------|\n|      1|Ahuja    |Rav       |Markham   |CA      |\n|      2|Chong    |Raul      |Toronto   |CA      |\n|      4|Sandip   |Saha      |Dhaka     |DB      |\n|      5|Doe      |John      |Dubai     |AE      |\n|      7|Cangiano |Antonio   |Vancouver |CA      |\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}